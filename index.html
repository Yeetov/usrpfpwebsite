<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="theme-color" content="#22c55e">
    <meta name="description" content="Unlock animated profile pictures on Discord client-side without Nitro.">
    <title>UserPFP | Animated Profiles</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet" />
    
    <style>
        /* --- CSS VARIABLES & RESET --- */
        :root {
            /* Modern Dark Theme Palette */
            --bg-deep: #111214;         /* App Background */
            --bg-primary: #313338;      /* Chat/Main Background */
            --bg-secondary: #2b2d31;    /* Cards/Sidebar */
            --bg-tertiary: #1e1f22;     /* Inputs/Nav */
            --bg-floating: #18191c;     /* Modals/Dropdowns */
            
            --modifier-hover: rgba(255, 255, 255, 0.05);
            --modifier-active: rgba(255, 255, 255, 0.1);
            
            --text-normal: #dbdee1;
            --text-muted: #949ba4;
            --text-header: #f2f3f5;
            --text-link: #00a8fc;
            
            /* Brand Colors */
            --brand: #22c55e;
            --brand-hover: #16a34a;
            --brand-gradient: linear-gradient(135deg, #22c55e 0%, #4ade80 100%);
            
            /* Status Colors */
            --status-online: #23a559;
            --status-idle: #f0b232;
            --status-dnd: #f23f43;
            --status-offline: #80848e;

            --font-primary: 'Inter', 'gg sans', system-ui, sans-serif;
            --font-code: 'Roboto Mono', monospace;

            --radius-md: 8px;
            --radius-lg: 16px;
            --radius-xl: 24px;
            
            --shadow-sm: 0 2px 4px rgba(0,0,0,0.1);
            --shadow-md: 0 8px 16px rgba(0,0,0,0.2);
            --shadow-lg: 0 16px 32px rgba(0,0,0,0.3);
        }

        html {
            scroll-behavior: smooth;
        }

        * { box-sizing: border-box; }
        
        body {
            margin: 0;
            padding: 0;
            font-family: var(--font-primary);
            background-color: var(--bg-primary);
            color: var(--text-normal);
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            line-height: 1.5;
            -webkit-font-smoothing: antialiased;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 10px; height: 10px; background-color: var(--bg-deep); }
        ::-webkit-scrollbar-thumb { background-color: var(--bg-secondary); border-radius: 5px; border: 2px solid var(--bg-deep); }
        ::-webkit-scrollbar-track { background-color: var(--bg-deep); }

        /* Typography */
        h1, h2, h3, h4 { color: var(--text-header); margin: 0; }
        
        h1 {
            font-weight: 800;
            font-size: clamp(2.5rem, 6vw, 4.5rem);
            letter-spacing: -0.03em;
            line-height: 1.1;
        }

        h2 {
            font-weight: 700;
            font-size: 2rem;
            margin-bottom: 1rem;
            letter-spacing: -0.02em;
        }

        a { text-decoration: none; color: inherit; transition: 0.2s; }
        p { color: var(--text-muted); font-size: 1.125rem; line-height: 1.6; }

        /* --- ANIMATIONS --- */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes scrollColumn { 0% { transform: translateY(0); } 100% { transform: translateY(-50%); } }
        @keyframes spin { to { transform: rotate(360deg); } }
        @keyframes float { 0% { transform: translateY(0px); } 50% { transform: translateY(-10px); } 100% { transform: translateY(0px); } }
        
        /* Dropdown Animation */
        @keyframes dropdownEnter {
            0% { opacity: 0; transform: translateX(-50%) translateY(-10px) scale(0.95); }
            100% { opacity: 1; transform: translateX(-50%) translateY(0) scale(1); }
        }

        /* --- UI COMPONENTS --- */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 14px 32px;
            border-radius: 28px;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.2s cubic-bezier(0.2, 0.8, 0.2, 1);
            cursor: pointer;
            border: none;
            position: relative;
            overflow: hidden;
            line-height: 1; /* Fix vertical alignment */
            height: 48px; /* Fixed height for consistency */
            text-decoration: none;
        }

        .btn-brand {
            background: var(--brand);
            color: #fff;
            box-shadow: 0 8px 16px rgba(34, 197, 94, 0.2);
        }
        .btn-brand:hover { 
            background: var(--brand-hover); 
            transform: translateY(-2px);
            box-shadow: 0 12px 24px rgba(34, 197, 94, 0.3);
        }
        .btn-brand:active { transform: translateY(0); }

        .btn-secondary {
            background-color: var(--bg-secondary);
            color: var(--text-header);
            border: 1px solid rgba(255,255,255,0.05);
        }
        .btn-secondary:hover { 
            background-color: var(--modifier-hover);
            border-color: rgba(255,255,255,0.1);
        }

        /* --- DROPDOWN --- */
        .dropdown { 
            position: relative; 
            display: inline-flex; 
            vertical-align: middle;
            width: 100%; /* Fill step card width */
        }
        
        .dropdown-menu {
            display: none;
            position: absolute;
            top: calc(100% + 12px); /* Spacing */
            left: 50%;
            transform: translateX(-50%);
            background: var(--bg-floating);
            width: 100%; /* Match parent width */
            min-width: 240px;
            max-width: 90vw;
            border-radius: 12px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.4);
            border: 1px solid rgba(255,255,255,0.08);
            z-index: 10000;
            overflow: hidden;
            flex-direction: column;
            transform-origin: top center;
        }
        .dropdown-menu.show { 
            display: flex; 
            animation: dropdownEnter 0.25s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
        }
        
        /* Arrow tip for dropdown */
        .dropdown-menu::before {
            content: '';
            position: absolute;
            top: -6px;
            left: 50%;
            transform: translateX(-50%) rotate(45deg);
            width: 12px;
            height: 12px;
            background: var(--bg-floating); /* Matches bg */
            border-left: 1px solid rgba(255,255,255,0.08);
            border-top: 1px solid rgba(255,255,255,0.08);
            z-index: 0;
        }
        
        .dropdown-header {
            padding: 12px 16px;
            font-size: 0.75rem;
            text-transform: uppercase;
            font-weight: 800;
            color: var(--text-muted);
            background: rgba(0,0,0,0.2);
            border-bottom: 1px solid rgba(255,255,255,0.05);
            position: relative;
            z-index: 1;
        }

        .dropdown-search-wrapper {
            padding: 10px;
            border-bottom: 1px solid rgba(255,255,255,0.05);
            position: relative;
            z-index: 1;
            background: var(--bg-floating);
        }

        .dropdown-search {
            width: 100%;
            background: var(--bg-deep);
            border: 1px solid rgba(255,255,255,0.1);
            padding: 8px 12px;
            border-radius: 6px;
            color: var(--text-normal);
            font-family: var(--font-primary);
            font-size: 0.9rem;
            outline: none;
            transition: border-color 0.2s;
        }
        .dropdown-search:focus {
            border-color: var(--brand);
        }

        .dropdown-list-container {
            max-height: 250px;
            overflow-y: auto;
            position: relative;
            z-index: 1;
            background: var(--bg-floating);
        }

        .dropdown-item {
            padding: 12px 16px;
            color: var(--text-normal);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all 0.15s ease;
            font-size: 0.95rem;
            font-weight: 500;
            text-decoration: none;
            border-left: 3px solid transparent;
        }
        .dropdown-item:hover { 
            background: var(--modifier-hover); 
            color: #fff; 
            border-left-color: var(--brand);
            padding-left: 19px; 
        }
        .dropdown-item img { width: 24px; height: 24px; border-radius: 6px; object-fit: contain; }

        /* --- NAVBAR --- */
        .navbar {
            background-color: rgba(17, 18, 20, 0.7);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            padding: 1.25rem 2rem;
            position: sticky;
            top: 0;
            z-index: 1000;
            display: flex;
            justify-content: center;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }

        .nav-inner {
            width: 100%;
            max-width: 1200px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-brand {
            font-weight: 900;
            font-size: 1.5rem;
            color: var(--text-header);
            display: flex;
            align-items: center;
            gap: 0;
            letter-spacing: -0.02em;
        }

        .nav-brand span { color: var(--brand); }

        .nav-links {
            display: flex;
            gap: 2.5rem;
            align-items: center;
            background: rgba(0,0,0,0.2);
            padding: 0.5rem 1.5rem;
            border-radius: 2rem;
            border: 1px solid rgba(255,255,255,0.05);
        }

        .nav-link {
            color: var(--text-muted);
            font-weight: 600;
            font-size: 0.95rem;
            transition: color 0.2s ease;
        }
        .nav-link:hover { color: var(--text-header); }
        .nav-link.active { color: var(--brand); }

        /* --- BACKGROUND --- */
        .bg-container {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none;
            z-index: 0;
            overflow: hidden;
        }

        .pfp-column {
            position: absolute;
            width: 80px;
            top: -10px; bottom: -10px;
            opacity: 0.08; 
            mask-image: linear-gradient(to bottom, transparent, black 20%, black 80%, transparent);
            -webkit-mask-image: linear-gradient(to bottom, transparent, black 20%, black 80%, transparent);
        }
        
        .col-left { left: 5%; }
        .col-right { right: 5%; }

        .pfp-track {
            display: flex;
            flex-direction: column;
            gap: 16px;
            animation: scrollColumn 80s linear infinite;
        }

        .bg-pfp {
            width: 80px; height: 80px;
            border-radius: 20px; /* Slight squircle for BG */
            background: var(--bg-tertiary);
            object-fit: cover;
            filter: grayscale(100%) contrast(1.2);
            box-shadow: var(--shadow-sm);
        }

        /* --- MAIN VIEWS --- */
        .view-container {
            display: none;
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 6rem 1.5rem;
            position: relative;
            z-index: 1;
        }
        
        .view-container.active { display: block; animation: fadeIn 0.6s cubic-bezier(0.16, 1, 0.3, 1); }

        /* HOME HERO */
        .hero-section {
            text-align: center;
            margin-bottom: 6rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2rem;
            position: relative;
        }

        .hero-title h1 {
            color: var(--text-header);
        }

        .hero-title span { 
            background: var(--brand-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: inline-block;
        }
        
        .hero-desc {
            max-width: 640px;
            margin: 0 auto;
            font-size: 1.25rem;
            color: var(--text-muted);
        }

        .hero-buttons {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center; 
            position: relative; 
        }

        /* STEPS GRID (Modern Cards) */
        .steps-section { 
            margin-bottom: 6rem; 
            position: relative; 
            z-index: 20; /* FIX: Ensure dropdown is above mod grid */
        }
        
        .steps-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
        }

        .step-card {
            background: var(--bg-secondary);
            padding: 2rem;
            border-radius: var(--radius-lg);
            border: 1px solid rgba(255,255,255,0.03);
            display: flex;
            flex-direction: column;
            gap: 1rem;
            transition: transform 0.2s, background-color 0.2s;
            position: relative;
            /* overflow: hidden; Removed to allow dropdown */
        }

        .step-card:hover {
            transform: translateY(-5px);
            background-color: #2e3035;
            border-color: rgba(255,255,255,0.08);
        }

        .step-num {
            font-family: var(--font-code);
            color: var(--brand);
            font-size: 3rem;
            font-weight: 700;
            opacity: 0.2;
            position: absolute;
            top: 1rem;
            right: 1.5rem;
        }

        .step-card h3 { font-size: 1.25rem; z-index: 1; }
        .step-card p { font-size: 1rem; z-index: 1; color: var(--text-muted); }
        .step-card a { color: var(--brand); font-weight: 600; }
        .step-card a:hover { text-decoration: underline; }

        /* MODS GRID */
        .mod-section { text-align: center; }
        
        .mod-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 1.5rem;
            justify-items: center;
            max-width: 800px;
            margin: 3rem auto 0;
        }

        .mod-btn {
            width: 96px; height: 96px;
            background: var(--bg-secondary);
            border-radius: 24px; /* Squircle */
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            position: relative;
            box-shadow: var(--shadow-sm);
            border: 2px solid transparent;
        }

        .mod-btn:hover {
            background: var(--brand);
            transform: translateY(-8px) scale(1.05);
            box-shadow: 0 10px 20px rgba(34, 197, 94, 0.3);
        }

        .mod-btn img {
            width: 52px; height: 52px;
            object-fit: contain;
            border-radius: 12px;
            pointer-events: none;
            filter: drop-shadow(0 4px 6px rgba(0,0,0,0.2));
        }

        .mod-label {
            position: absolute;
            bottom: -32px;
            color: var(--text-muted);
            font-size: 0.8rem;
            font-weight: 600;
            opacity: 0;
            transform: translateY(-5px);
            transition: 0.2s;
            white-space: nowrap;
        }
        .mod-btn:hover .mod-label { opacity: 1; transform: translateY(0); color: var(--text-normal); }

        /* STAFF CARDS (Discord Profile Style) */
        .staff-grid {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 24px;
        }

        .profile-card {
            width: 100%; 
            max-width: 320px; /* Fluid width for phones */
            min-width: 280px;
            background: var(--bg-deep);
            border-radius: var(--radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow-md);
            position: relative;
            transition: transform 0.2s, box-shadow 0.2s;
            border: 1px solid rgba(255,255,255,0.03);
        }
        
        .profile-card:hover { 
            transform: translateY(-6px); 
            box-shadow: var(--shadow-lg); 
        }

        .profile-banner {
            height: 105px;
            background-color: var(--brand);
            background-size: cover;
            background-position: center;
        }

        .profile-avatar-container {
            position: absolute;
            top: 61px;
            left: 16px;
        }

        .profile-avatar {
            width: 88px; height: 88px;
            border-radius: 50%;
            border: 6px solid var(--bg-deep);
            background-color: var(--bg-deep);
            position: relative;
            z-index: 10;
        }

        .profile-avatar img {
            width: 100%; height: 100%;
            border-radius: 50%;
            object-fit: cover;
        }

        .status-badge {
            position: absolute;
            bottom: 0px; right: 0px;
            width: 28px; height: 28px;
            background: var(--bg-deep);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 11;
        }
        
        .status-dot { width: 18px; height: 18px; border-radius: 50%; }
        .status-dot.online { background-color: var(--status-online); }
        .status-dot.idle { background-color: var(--status-idle); }
        .status-dot.dnd { background-color: var(--status-dnd); }
        .status-dot.offline { background-color: var(--status-offline); }

        .profile-body {
            margin-top: 50px;
            padding: 16px;
            background: var(--bg-deep);
        }

        .profile-name-container { margin-bottom: 12px; }

        .profile-displayname {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text-header);
            line-height: 1.2;
        }

        .profile-username {
            font-size: 0.9rem;
            color: var(--text-header);
            font-weight: 500;
        }

        /* Activity Card */
        .activity-card {
            background-color: var(--bg-primary); 
            border-radius: 8px;
            padding: 12px;
            margin-top: 12px;
            font-size: 0.85rem;
        }

        .activity-header {
            font-weight: 800;
            text-transform: uppercase;
            font-size: 0.75rem;
            color: var(--text-header);
            margin-bottom: 8px;
        }

        .activity-row {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .activity-icon {
            width: 36px; height: 36px;
            border-radius: 4px;
            object-fit: cover;
        }

        .activity-info {
            display: flex;
            flex-direction: column;
            overflow: hidden;
            flex: 1;
        }

        .activity-title { font-weight: 600; color: var(--text-normal); white-space: nowrap; text-overflow: ellipsis; overflow: hidden; font-size: 0.9rem; }
        .activity-subtitle { color: var(--text-muted); white-space: nowrap; text-overflow: ellipsis; overflow: hidden; }

        /* BADGES */
        .badge-container {
            position: absolute;
            top: 110px; right: 16px;
            display: flex;
            gap: 4px;
            align-items: center;
            flex-wrap: wrap;
            justify-content: flex-end;
            max-width: 170px; /* Constrain width to force wrapping before hitting avatar */
        }
        
        /* Updated badge styles for both images and text chips */
        .badge-icon {
            width: 22px;
            height: 22px;
            object-fit: contain;
            cursor: pointer; /* Changed from help to pointer */
        }

        .badge-chip {
            background: var(--bg-secondary);
            padding: 0 6px;
            height: 22px; /* Match icon height */
            border-radius: 4px;
            font-size: 10px;
            font-weight: 700;
            text-transform: uppercase;
            color: var(--text-muted);
            border: 1px solid rgba(255,255,255,0.05);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* --- MODAL WIZARD --- */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.85);
            z-index: 2000;
            display: none;
            justify-content: center;
            align-items: center;
            padding: 20px;
            opacity: 0;
            transition: opacity 0.2s;
            backdrop-filter: blur(8px);
        }

        .modal-overlay.open { display: flex; opacity: 1; }

        .modal-content {
            background: var(--bg-primary);
            padding: 0; 
            border-radius: var(--radius-lg);
            width: 100%;
            max-width: 550px;
            transform: scale(0.95) translateY(10px);
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: var(--shadow-lg);
            border: 1px solid rgba(255,255,255,0.08);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            text-align: center; /* Center everything */
        }

        .modal-overlay.open .modal-content { transform: scale(1) translateY(0); }

        /* Wizard Header */
        .modal-header-bg {
            background: var(--bg-deep);
            padding: 2rem;
            display: flex;
            flex-direction: column; /* Stack logo and text */
            align-items: center;
            gap: 1rem;
            border-bottom: 1px solid rgba(255,255,255,0.05);
            position: relative;
        }

        .modal-client-icon {
            width: 80px; height: 80px;
            background: var(--bg-secondary);
            border-radius: 20px;
            padding: 12px;
            object-fit: contain;
            box-shadow: var(--shadow-sm);
        }

        .modal-title-wrap h3 { margin: 0; font-size: 1.75rem; color: var(--text-header); }
        .modal-title-wrap p { margin: 0.25rem 0 0; font-size: 1rem; color: var(--text-muted); }

        .close-modal {
            position: absolute;
            top: 1rem; right: 1rem;
            background: rgba(0,0,0,0.2);
            border-radius: 50%;
            width: 32px; height: 32px;
            display: flex; align-items: center; justify-content: center;
            border: none;
            color: var(--text-muted);
            font-size: 1.5rem;
            line-height: 1;
            cursor: pointer;
            transition: all 0.2s;
        }
        .close-modal:hover { background: var(--bg-modifier-hover); color: var(--text-header); }

        /* Wizard Body */
        .modal-body {
            padding: 2rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 200px; /* Avoid layout shifts */
        }

        .wizard-step {
            display: none;
            flex-direction: column;
            align-items: center;
            gap: 1.5rem;
            animation: fadeIn 0.3s ease;
            width: 100%;
        }
        .wizard-step.active { display: flex; }

        .wizard-text {
            font-size: 1.1rem;
            line-height: 1.6;
            color: var(--text-normal);
            max-width: 400px;
        }

        /* Code Editor Look */
        .code-window {
            background: #1e1f22; 
            border-radius: 8px;
            border: 1px solid rgba(255,255,255,0.05);
            overflow: hidden;
            width: 100%;
            text-align: left;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.2);
        }
        .code-header {
            background: #2b2d31;
            padding: 8px 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(0,0,0,0.2);
        }
        .code-lang { font-family: var(--font-code); font-size: 0.75rem; color: var(--text-muted); text-transform: uppercase; }
        .copy-code-btn {
            background: transparent; border: none; color: var(--brand); font-weight: 600; 
            font-size: 0.8rem; cursor: pointer; display: flex; align-items: center; gap: 6px;
        }
        
        .code-content {
            padding: 16px;
            font-family: var(--font-code);
            font-size: 0.85rem;
            color: #d4d4d4;
            overflow-x: auto;
            white-space: pre-wrap;
            word-break: break-all;
        }

        .btn-link {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-secondary);
            padding: 14px 24px;
            border-radius: 8px;
            font-weight: 600;
            color: var(--brand);
            border: 1px solid rgba(255,255,255,0.05);
            transition: all 0.2s;
        }
        .btn-link:hover { background: var(--modifier-hover); color: #fff; transform: translateY(-2px); }

        /* Wizard Nav Buttons */
        .wizard-nav {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
            width: 100%;
            justify-content: center;
        }
        .btn-wizard {
            padding: 10px 24px;
            border-radius: 24px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: 0.2s;
        }
        .btn-prev { background: transparent; color: var(--text-muted); }
        .btn-prev:hover { color: var(--text-normal); background: var(--modifier-hover); }
        .btn-next { background: var(--brand); color: #fff; }
        .btn-next:hover { background: var(--brand-hover); }

        /* FOOTER */
        .footer {
            margin-top: auto;
            padding: 4rem 2rem;
            background: var(--bg-deep);
            text-align: center;
            border-top: 1px solid var(--bg-tertiary);
        }
        .footer-links { display: flex; justify-content: center; gap: 2.5rem; margin-bottom: 2rem; font-weight: 600; }
        .footer-links a { color: var(--text-muted); }
        .footer-links a:hover { color: var(--brand); }
        .footer-copy { color: var(--text-muted); font-size: 0.9rem; opacity: 0.7; }

        /* Loader */
        .loader {
            width: 48px; height: 48px;
            border: 4px solid var(--bg-tertiary);
            border-top-color: var(--brand);
            border-radius: 50%;
            animation: spin 1s infinite linear;
            margin: 60px auto;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .bg-container { display: none; }
            .navbar { padding: 1rem 1.25rem; }
            .nav-inner { flex-direction: column; gap: 1rem; }
            .nav-brand { margin-bottom: 0.25rem; }
            .nav-links { 
                width: 100%; 
                justify-content: center; 
                gap: 1.5rem; 
                background: transparent; 
                border: none; 
                padding: 0; 
                flex-wrap: wrap; 
            }
            .nav-cta { 
                display: block; 
                width: 100%; 
                text-align: center;
            }
            h1 { font-size: 2.5rem; }
            .hero-section { margin-bottom: 4rem; padding: 0 1rem; }
            .hero-desc { font-size: 1.1rem; }
            .steps-grid { grid-template-columns: 1fr; }
            .staff-card { width: 100%; max-width: 320px; }
            .modal-content { padding: 0; }
        }
    </style>
</head>
<body>

    <!-- ANIMATED BACKGROUND -->
    <div class="bg-container" id="bgAnim">
        <div class="pfp-column col-left"><div class="pfp-track" id="track1"></div></div>
        <div class="pfp-column col-right"><div class="pfp-track" id="track2"></div></div>
    </div>

    <!-- NAVBAR -->
    <nav class="navbar">
        <div class="nav-inner">
            <a href="#home" class="nav-brand">
                <span>User</span>PFP
            </a>
            <div class="nav-links">
                <a href="#home" class="nav-link active">Home</a>
                <a href="#staff" class="nav-link">Staff</a>
                <a href="https://github.com/UserPFP/UserPFP" target="_blank" class="nav-link">GitHub</a>
                <a href="https://discord.gg/userpfp-1129784704267210844" target="_blank" class="nav-link">Discord</a>
            </div>
        </div>
    </nav>

    <!-- HOME VIEW -->
    <main id="home-view" class="view-container active">
        <section class="hero-section">
            <div class="hero-title">
                <h1>Unlock Animated<br><span>Profile Pictures</span></h1>
            </div>
            <p class="hero-desc">
                UserPFP is a client modification that unlocks animated profile pictures on Discord without Nitro. It also supports API images and GIFs (such as random duck or cat images), visible to all other users of the mod.
            </p>
            <div class="hero-buttons">
                <a href="#steps" class="btn btn-brand">Get Started</a>
                <a href="https://discord.gg/userpfp-1129784704267210844" target="_blank" class="btn btn-secondary">Join Server</a>
            </div>
        </section>

        <section id="steps" class="steps-section">
            <h2 style="text-align:center;">How It Works</h2>
            <div class="steps-grid">
                <div class="step-card">
                    <div class="step-num">01</div>
                    <h3>Join the Community</h3>
                    <p>Join the <a href="https://discord.gg/userpfp-1129784704267210844" target="_blank">Official Discord Server</a> to submit requests for animated PFPs or dynamic links. Support is also available here.</p>
                </div>
                <div class="step-card">
                    <div class="step-num">02</div>
                    <h3>Submit Request</h3>
                    <p>Upload your GIF or link in <code>#request-here</code>. If accepted, our GitHub bot hosts it automatically. Restart your client after ~5 mins to see changes!</p>
                </div>
                <div class="step-card">
                    <div class="step-num">03</div>
                    <h3>Install</h3>
                    <p>Select your preferred client to view specific installation instructions.</p>
                    <div class="dropdown" style="width: 100%; margin-top: auto;">
                        <button class="btn btn-secondary" style="width:100%;" onclick="toggleDropdown(event)">Choose Client</button>
                        <div class="dropdown-menu" id="clientDropdown">
                            <!-- Populated by JS -->
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="mod-section">
            <h2>Supported Clients</h2>
            <p style="margin-bottom: 2rem;">Click an icon to view installation instructions.</p>
            <div class="mod-grid" id="modGrid">
                <!-- Javascript will populate this -->
            </div>
        </section>
    </main>

    <!-- STAFF VIEW -->
    <main id="staff-view" class="view-container">
        <div style="text-align:center; margin-bottom: 5rem;">
            <h1>Meet The Team</h1>
            <p>The developers and staff making UserPFP possible.</p>
        </div>
        <div id="staffLoader" class="loader"></div>
        <div class="staff-grid" id="staffGrid">
            <!-- Javascript will populate this -->
        </div>
    </main>

    <!-- FOOTER -->
    <footer class="footer">
        <div class="footer-links">
            <a href="https://github.com/UserPFP/UserPFP" target="_blank">Source Code</a>
            <a href="https://discord.gg/userpfp-1129784704267210844" target="_blank">Support</a>
        </div>
        <div class="footer-copy">
            &copy; 2025 UserPFP. Not affiliated with Discord Inc.
        </div>
    </footer>

    <!-- MODAL -->
    <div class="modal-overlay" id="infoModal">
        <div class="modal-content">
            <!-- Header with Logo -->
            <div class="modal-header-bg">
                <img id="modalClientIcon" class="modal-client-icon" src="" alt="Client">
                <div class="modal-title-wrap">
                    <h3 id="modalTitle">Mod Name</h3>
                    <p>Installation Wizard</p>
                </div>
                <button class="close-modal" onclick="closeModal()">Ã—</button>
            </div>
            
            <!-- Body -->
            <div class="modal-body" id="modalBody">
                <!-- Injected via JS -->
            </div>
        </div>
    </div>

    <!-- MAIN SCRIPT -->
    <script>
        // --- CONFIGURATION ---
        const modData = {
            equicord: { 
                logo: "https://equicord.org/assets/icons/equicord/icon-black.png",
                desc: "Equicord includes a plugin by default, go to Settings > Plugins > Search for UserPFP and turn the plugin on!",
                code: null 
            },
            vencord: { 
                logo: "https://equicord.org/assets/icons/vencord/icon.png",
                desc: "Vencord only supports using the Theme for now, copy this link and paste it into Settings > Themes > Online Themes",
                code: "https://raw.githubusercontent.com/UserPFP/UserPFP/main/userpfp.theme.css" 
            },
            betterdiscord: { 
                logo: "https://images.equicord.org/api/undefined/files/raw/019a5260-8ca4-7008-a89e-30427975b652",
                title: "Web-Based / BetterDiscord",
                desc: "To use UserPFP on any web-based client, simply add the following line to the top of your CustomCSS/QuickCSS file. Note: The CSS/Theme implementation is not recommended if other options are available.",
                code: "@import url('https://raw.githubusercontent.com/UserPFP/UserPFP/main/userpfp.theme.css');" 
            },
            replugged: {
                logo: "https://images.equicord.org/api/undefined/files/raw/019a5260-8ca4-7006-8ac6-8512377d1f58",
                desc: "You can install the plugin from the official plugin store",
                link: "https://replugged.dev/store/dev.WolfPlugs.UserPFP"
            },
            aliucord: {
                logo: "https://images.equicord.org/api/undefined/files/raw/019a5260-8ca4-7004-844b-04dbc906256c",
                desc: "You can download the plugin file from this link",
                link: "https://github.com/OmegaSunkey/awesomeplugins/raw/builds/UserPFP.zip"
            },
            vendetta: {
                logo: "https://images.equicord.org/api/undefined/files/raw/019a5260-8ca4-7003-8d7d-5e59de0a38d3",
                desc: "Copy this link and add it to your plugins",
                link: "https://revenge.nexpid.xyz/userpfp"
            },
             shelter: { 
                 logo: "https://images.equicord.org/api/undefined/files/raw/019a5260-8ca4-7005-a865-2d3cc2f6b23c",
                 desc: "Add this link to your plugins", 
                 link: "https://spikehd.dev/shelter-plugins/userpfp/" 
            },
            bunny: {
                logo: "https://images.equicord.org/api/undefined/files/raw/019a5260-8ca4-7002-af09-71777b39c12f",
                desc: "All of these are based on the same system, simply copy this link and add it to your plugins",
                link: "https://revenge.nexpid.xyz/userpfp"
            },
            revenge: {
                logo: "https://images.equicord.org/api/undefined/files/raw/019a5260-8ca4-7000-94cc-2800ec57cd07",
                desc: "All of these are based on the same system, simply copy this link and add it to your plugins",
                link: "https://revenge.nexpid.xyz/userpfp"
            },
            kettu: {
                logo: "https://images.equicord.org/api/undefined/files/raw/019a5260-8ca4-7001-ad48-2d37d308f96f",
                desc: "All of these are based on the same system, simply copy this link and add it to your plugins",
                link: "https://revenge.nexpid.xyz/userpfp"
            }
        };

        const staffIds = [
            "406084422308331522", "789872551731527690", "853550207039832084", 
            "848339671629299742", "500212086765518858", "250322741406859265", 
            "929208515883569182", "258731845267619840", "1180778779682033715", 
            "1124647765075566662", "613725399263739926", "422319200095436800"
        ];

        const manualBanners = {
            "406084422308331522": "https://i.imgur.com/vzyxjz8.gif", 
            "789872551731527690": "https://i.imgur.com/U3xaMjR.gif",
            "853550207039832084": "https://i.ibb.co/MBY0qxx/nexpid.gif",
            "848339671629299742": "https://i.imgur.com/FiRr8Lj.png",
            "500212086765518858": "https://i.imgur.com/bAuCtgB.png",
            "250322741406859265": "https://i.imgur.com/mkTL1S8.png",
            "929208515883569182": "https://i.imgur.com/ZflpQQ3.png",
            "258731845267619840": "https://i.imgur.com/2mitqtb.png"
        };
        
        // State
        const customPfps = {};
        let usrbgData = null;
        let currentWizardStep = 0;
        let wizardSteps = [];

        // --- CORE LOGIC ---

        function init() {
            renderMods();
            renderDropdown();
            handleRoute();
            window.addEventListener('hashchange', handleRoute);
            if(window.innerWidth > 768) loadBackgroundPfps();
            document.getElementById('infoModal').addEventListener('click', (e) => {
                if(e.target.id === 'infoModal') closeModal();
            });
            window.addEventListener('click', () => {
                const menu = document.getElementById('clientDropdown');
                if(menu && menu.classList.contains('show')) menu.classList.remove('show');
            });
            if (window.location.pathname.includes('/website')) {
                const currentHash = window.location.hash || '#home';
                window.location.replace('/' + currentHash);
            }
        }

        function handleRoute() {
            let viewName = window.location.hash.replace('#', '') || 'home';
            if (!['home', 'staff'].includes(viewName)) viewName = 'home';
            
            // Smooth scroll for anchors, otherwise jump
            if(viewName !== 'home') window.scrollTo(0,0);

            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === `#${viewName}`) link.classList.add('active');
            });

            document.querySelectorAll('.view-container').forEach(view => view.classList.remove('active'));
            document.getElementById(`${viewName}-view`).classList.add('active');

            const bgContainer = document.getElementById('bgAnim');
            if(viewName === 'home') {
                if(bgContainer) bgContainer.style.display = 'block';
            } else if (viewName === 'staff') {
                if(bgContainer) bgContainer.style.display = 'none';
                if(!window.staffLoaded) loadStaff();
            }
            
            // Scroll top instantly for view changes (ignore smooth scroll css)
            if(viewName !== 'home') window.scrollTo({ top: 0, behavior: 'instant' });
        }

        // --- DATA FETCHERS ---
        async function fetchCustomPfps() {
            try {
                let res = await fetch('https://raw.githubusercontent.com/Yeetov/usrpfpwebsite/main/import.css');
                if (!res.ok) res = await fetch('https://raw.githubusercontent.com/UserPFP/UserPFP/main/import.css');
                if (!res.ok) throw new Error('Failed');
                const css = await res.text();
                const regex = /src\^="https:\/\/cdn\.discordapp\.com\/avatars\/(\d+)\/".*?url\(([^)]+)\)/g;
                let match;
                while ((match = regex.exec(css)) !== null) {
                    customPfps[match[1]] = match[2].replace(/['"]/g, ''); 
                }
            } catch (e) { console.error(e); }
        }

        async function fetchUsrbg() {
            try {
                const res = await fetch("https://usrbg.is-hardly.online/users");
                if (res.ok) usrbgData = await res.json();
            } catch (e) { console.error(e); }
        }

        function getUsrbgUrl(userId) {
            if (!usrbgData || !usrbgData.users[userId]) return null;
            const { endpoint, bucket, prefix, users: { [userId]: etag } } = usrbgData;
            return `${endpoint}/${bucket}/${prefix}${userId}?${etag}`;
        }

        // --- UI RENDERERS ---
        function renderMods() {
            const grid = document.getElementById('modGrid');
            Object.entries(modData).forEach(([key, data]) => {
                const btn = document.createElement('div');
                btn.className = 'mod-btn';
                btn.innerHTML = `
                    <img src="${data.logo}" alt="${key}">
                    <span class="mod-label">${key.charAt(0).toUpperCase() + key.slice(1)}</span>
                `;
                btn.onclick = () => openModal(key, data);
                grid.appendChild(btn);
            });
        }

        function renderDropdown() {
            const menu = document.getElementById('clientDropdown');
            if(!menu) return;
            menu.innerHTML = `
                <div class="dropdown-header">Select Client</div>
                <div class="dropdown-search-wrapper">
                    <input type="text" id="clientSearch" class="dropdown-search" placeholder="Search..." oninput="filterDropdown()">
                </div>
                <div id="dropdownList" class="dropdown-list-container"></div>
            `;
            const list = document.getElementById('dropdownList');
            Object.entries(modData).forEach(([key, data]) => {
                const item = document.createElement('div');
                item.className = 'dropdown-item';
                item.setAttribute('data-name', key); 
                item.onclick = () => {
                    document.getElementById('clientDropdown').classList.remove('show');
                    setTimeout(() => openModal(key, data), 200);
                };
                item.innerHTML = `<img src="${data.logo}" alt="${key}"> ${key.charAt(0).toUpperCase() + key.slice(1)}`;
                list.appendChild(item);
            });
        }

        function filterDropdown() {
            const filter = document.getElementById('clientSearch').value.toLowerCase();
            document.querySelectorAll('.dropdown-item').forEach(item => {
                item.style.display = item.getAttribute('data-name').toLowerCase().includes(filter) ? "flex" : "none";
            });
        }

        function toggleDropdown(e) {
            if(e) e.stopPropagation();
            const menu = document.getElementById('clientDropdown');
            menu.classList.toggle('show');
            if(menu.classList.contains('show')) setTimeout(() => document.getElementById('clientSearch').focus(), 100);
        }

        // --- STAFF LOGIC ---
        async function loadStaff() {
            window.staffLoaded = true;
            const grid = document.getElementById('staffGrid');
            const loader = document.getElementById('staffLoader');
            grid.innerHTML = ''; 
            loader.style.display = 'block';

            try {
                // Fetch external data concurrently (CSS PFPs, USRBG)
                await Promise.all([fetchCustomPfps(), fetchUsrbg()]);

                const shuffled = staffIds.sort(() => 0.5 - Math.random());

                // Create array of fetch promises for each staff user
                const userPromises = shuffled.map(async id => {
                    try {
                        const [lanyardRes, badgesRes] = await Promise.all([
                            fetch(`https://lanyard.equicord.org/v1/users/${id}`).then(r => r.json()),
                            fetch(`https://badges.equicord.org/${id}`).then(r => r.json()).catch(() => null) // Allow badges to fail gracefully
                        ]);
                        
                        return lanyardRes.success ? { id, data: lanyardRes.data, badges: badgesRes || [] } : null;
                    } catch(e) {
                        return null; 
                    }
                });

                const results = await Promise.all(userPromises);
                
                let html = '';
                results.forEach(r => { if(r) html += createStaffCard(r.data, r.id, r.badges); });
                loader.style.display = 'none';
                grid.innerHTML = html;
            } catch(e) {
                console.error(e);
                loader.style.display = 'none';
                grid.innerHTML = '<p style="color:var(--text-muted)">Unable to load staff members.</p>';
            }
        }

        function createStaffCard(data, id, badgeData) {
            const user = data.discord_user;
            const avatar = customPfps[id] || (user.avatar ? `https://cdn.discordapp.com/avatars/${id}/${user.avatar}.${user.avatar.startsWith('a_')?'gif':'webp'}?size=128` : 'https://cdn.discordapp.com/embed/avatars/0.png');
            let banner = getUsrbgUrl(id) || manualBanners[id] || "";
            const bannerStyle = banner ? `background-image: url('${banner}')` : '';
            const statusMap = { online:'online', idle:'idle', dnd:'dnd', offline:'offline' };
            
            // Render Badges
            let badgesHtml = '<div class="badge-chip">Staff</div>';
            
            // Handle Equicord Badges API response structure
            // API returns object with "badges" array containing { badge: "url", tooltip: "name" }
            if (badgeData && badgeData.badges && Array.isArray(badgeData.badges)) {
                 badgeData.badges.forEach(b => {
                    const imgUrl = b.badge || b.image; // Support "badge" from new API or "image" if format varies
                    const name = b.tooltip || b.name || "Badge";
                    
                    if(imgUrl) {
                        badgesHtml += `<img src="${imgUrl}" alt="${name}" class="badge-icon" title="${name}">`;
                    }
                });
            }

            let activityHtml = '';
            const rich = data.activities.find(a => a.type !== 4); 
            const custom = data.activities.find(a => a.type === 4); 
            
            if (rich) {
                const iconId = rich.assets?.large_image;
                const iconUrl = iconId ? (iconId.startsWith('mp:') ? `https://media.discordapp.net/${iconId.replace('mp:','')}` : `https://cdn.discordapp.com/app-assets/${rich.application_id}/${iconId}.png`) : null;
                activityHtml = `
                    <div class="activity-card">
                        <div class="activity-header">Playing</div>
                        <div class="activity-row">
                            ${iconUrl ? `<img src="${iconUrl}" class="activity-icon">` : ''}
                            <div class="activity-info">
                                <div class="activity-title">${rich.name}</div>
                                <div class="activity-subtitle">${rich.details || rich.state || ''}</div>
                            </div>
                        </div>
                    </div>`;
            } else if (custom && custom.state) {
                 activityHtml = `
                    <div class="activity-card">
                        <div class="activity-header">Custom Status</div>
                        <div class="activity-row"><div class="activity-info"><div class="activity-subtitle">${custom.emoji ? custom.emoji.name+' ' : ''}${custom.state}</div></div></div>
                    </div>`;
            }

            return `
                <div class="profile-card">
                    <div class="profile-banner" style="${bannerStyle}"></div>
                    <div class="badge-container">${badgesHtml}</div>
                    <div class="profile-avatar-container">
                        <div class="profile-avatar">
                            <img src="${avatar}" alt="${user.username}">
                            <div class="status-badge"><div class="status-dot ${statusMap[data.discord_status]||'offline'}"></div></div>
                        </div>
                    </div>
                    <div class="profile-body">
                        <div class="profile-name-container">
                            <div class="profile-displayname">${user.global_name || user.username}</div>
                            <div class="profile-username">@${user.username}</div>
                        </div>
                        ${activityHtml}
                    </div>
                </div>`;
        }

        // --- WIZARD LOGIC ---
        function openModal(title, data) {
            const modal = document.getElementById('infoModal');
            const displayTitle = data.title || (title.charAt(0).toUpperCase() + title.slice(1));
            
            document.getElementById('modalTitle').innerText = displayTitle;
            document.getElementById('modalClientIcon').src = data.logo;
            
            // Build Steps
            wizardSteps = [];
            
            // Step 1: Instruction
            wizardSteps.push({
                html: `<div class="wizard-text">${data.desc}</div>`
            });

            // Step 2: Action (if exists)
            if(data.code) {
                wizardSteps.push({
                    html: `
                        <div class="wizard-text">Copy the code below:</div>
                        <div class="code-window">
                            <div class="code-header">
                                <span class="code-lang">CSS / LINK</span>
                                <button class="copy-code-btn" onclick="copyCode(this, '${data.code}')"><span>COPY</span></button>
                            </div>
                            <div class="code-content">${data.code}</div>
                        </div>
                    `
                });
            } else if(data.link) {
                wizardSteps.push({
                    html: `
                        <div class="wizard-text">Click below to install:</div>
                        <a href="${data.link}" target="_blank" class="btn-link">Open Installation Link</a>
                    `
                });
            }

            // Start Wizard
            currentWizardStep = 0;
            renderStep();
            modal.classList.add('open');
        }

        function renderStep() {
            const container = document.getElementById('modalBody');
            const step = wizardSteps[currentWizardStep];
            const isLast = currentWizardStep === wizardSteps.length - 1;
            const isFirst = currentWizardStep === 0;

            let navHtml = `
                <div class="wizard-nav">
                    ${!isFirst ? `<button class="btn-wizard btn-prev" onclick="changeStep(-1)">Back</button>` : ''}
                    <button class="btn-wizard btn-next" onclick="${isLast ? 'closeModal()' : 'changeStep(1)'}">${isLast ? 'Done' : 'Next'}</button>
                </div>
            `;

            container.innerHTML = `
                <div class="wizard-step active">
                    ${step.html}
                    ${navHtml}
                </div>
            `;
        }

        function changeStep(dir) {
            currentWizardStep += dir;
            renderStep();
        }

        function closeModal() {
            document.getElementById('infoModal').classList.remove('open');
        }

        function copyCode(btn, text) {
            navigator.clipboard.writeText(text).then(() => {
                const span = btn.querySelector('span');
                const original = span.innerText;
                span.innerText = "COPIED!";
                btn.style.color = "var(--text-positive)";
                setTimeout(() => { span.innerText = original; btn.style.color = ""; }, 2000);
            });
        }

        // BG Logic (Moved here to allow init usage)
        async function loadBackgroundPfps() {
            try {
                const res = await fetch('https://raw.githubusercontent.com/Yeetov/usrpfpwebsite/main/source/data.json');
                const data = await res.json();
                const urls = Object.values(data.avatars||{}).filter(u=>!u.includes("profileBadges")&&u.startsWith("http")).sort(()=>0.5-Math.random()).slice(0,40);
                const fill = (id, items) => {
                    const el = document.getElementById(id);
                    if(!el) return;
                    [...items,...items].forEach(url=>{
                        const img=document.createElement('img');img.src=url;img.className='bg-pfp';img.loading='lazy';img.onerror=()=>img.remove();
                        el.appendChild(img);
                    });
                };
                fill('track1', urls.slice(0,20));
                fill('track2', urls.slice(20,40));
            } catch(e){}
        }

        init();
    </script>
</body>
</html>
